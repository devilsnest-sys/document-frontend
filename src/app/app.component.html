<div *ngIf="isLoading" class="loader-container">
    <div class="loader-content">
        <div class="modern-loader">
            <div class="loader-spinner"></div>
        </div>
        <p class="loader-text">Loading your dashboard...</p>
    </div>
</div>

<section class="erp-dashboard">
    <!-- Fixed Header with Integrated Notifications -->
    <div class="dashboard-header">
        <app-header></app-header>
        
        <!-- Notification Bell - Positioned in Header -->
        <div class="notification-wrapper">
            <button 
                class="notification-bell" 
                (click)="toggleNotifications()" 
                [class.has-notifications]="notifications.length > 0"
                aria-label="Notifications">
                <mat-icon>notifications</mat-icon>
                <span *ngIf="notifications.length > 0" class="notification-badge">
                    {{ notifications.length > 9 ? '9+' : notifications.length }}
                </span>
            </button>

            <!-- Enhanced Notifications Dropdown -->
            <div *ngIf="showNotifications" class="notifications-dropdown">
                <div class="dropdown-header">
                    <div class="header-title">
                        <mat-icon>notifications_active</mat-icon>
                        <h4>Notifications</h4>
                    </div>
                    <!-- <button 
                        *ngIf="notifications.length > 0" 
                        class="clear-all-btn" 
                        (click)="clearAllNotifications()">
                        Clear all
                    </button> -->
                </div>
                
                <div class="dropdown-body">
                    <div 
                        *ngFor="let msg of notifications; let i = index" 
                        class="notification-item"
                        [@slideIn]>
                        <div class="notification-icon-wrapper">
                            <mat-icon class="notification-icon">info</mat-icon>
                        </div>
                        <div class="notification-content">
                            <p class="notification-text">{{ msg }}</p>
                            <span class="notification-time">Just now</span>
                        </div>
                        <button 
                            class="dismiss-btn" 
                            (click)="removeNotification(i)" 
                            title="Dismiss"
                            aria-label="Dismiss notification">
                            <mat-icon>close</mat-icon>
                        </button>
                    </div>
                    
                    <div *ngIf="notifications.length === 0" class="empty-notifications">
                        <div class="empty-icon">
                            <mat-icon>notifications_off</mat-icon>
                        </div>
                        <h5>All caught up!</h5>
                        <p>No new notifications at the moment</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="dashboard-main">
        <div class="content-wrapper">
            <router-outlet></router-outlet>
        </div>
    </main>

    <!-- Footer -->
    <footer class="dashboard-footer" *ngIf="isLoggedIn">
        <app-footer></app-footer>
    </footer>
</section>